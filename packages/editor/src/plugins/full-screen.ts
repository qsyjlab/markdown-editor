import { MarkdownEditor } from "../editor";
import { generateSvg } from "../icon";
import { EditorPlugin } from "../plugin";

export function fullscreenPlugin(editor: MarkdownEditor): EditorPlugin {
  const name = "fullscreen";

  editor.iconManager.register({
    name,
    type: "html",
    html: generateSvg(
      '<path d="M256 316.330667V384a42.666667 42.666667 0 1 1-85.333333 0v-170.666667a42.666667 42.666667 0 0 1 42.666666-42.666666h170.666667a42.666667 42.666667 0 1 1 0 85.333333h-67.669333l97.834666 97.834667a42.666667 42.666667 0 1 1-60.330666 60.330666L256 316.330667zM640 256a42.666667 42.666667 0 1 1 0-85.333333h170.666667a42.666667 42.666667 0 0 1 42.666666 42.666666v170.666667a42.666667 42.666667 0 1 1-85.333333 0v-67.669333l-97.834667 97.834666a42.666667 42.666667 0 1 1-60.330666-60.330666L707.669333 256H640zM213.333333 597.333333a42.666667 42.666667 0 0 1 42.666667 42.666667v67.669333l97.834667-97.834666a42.666667 42.666667 0 1 1 60.330666 60.330666L316.330667 768H384a42.666667 42.666667 0 1 1 0 85.333333h-170.666667a42.666667 42.666667 0 0 1-42.666666-42.666666v-170.666667a42.666667 42.666667 0 0 1 42.666666-42.666667z m396.501334 72.832a42.666667 42.666667 0 1 1 60.330666-60.330666L768 707.669333V640a42.666667 42.666667 0 1 1 85.333333 0v170.666667a42.666667 42.666667 0 0 1-42.666666 42.666666h-170.666667a42.666667 42.666667 0 1 1 0-85.333333h67.669333l-97.834666-97.834667z"></path>'
    ),
  });

  editor.toolbarManager?.register({
    name,
    icon: name,
    label: "全屏",
    inActiveLabel: "全屏",
    activeLabel: "取消全屏",
    onAction: () => {
      editor.toggleFullscreen();

      editor.toolbarManager.updateMenuState(name, {
        isActive: editor.layoutState.fullscreen,
      });
    },
  });

  return {
    name,
  };
}
